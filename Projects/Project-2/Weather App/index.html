<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <title>Weather</title>
</head>

<body>
    <header>
        <div class="input-container">
            <input type="text" name="" id="" placeholder="Enter Location">
            <button id="search">Search</button>
        </div>
    </header>
    <main>
        <div class="weather-container">
            <div class="temprature">21.2</div>
            <div class="location-date">
                <div class="location">Delhi</div>
                <span class="time">12:43</span>
                <span class="day">Monday</span>
                <span class="date">2024-07-15</span>
            </div>
            <div class="weather-state">
                <div class="icon">
                    <img src="//cdn.weatherapi.com/weather/64x64/day/113.png" alt="">
                </div>
                <div class="condition">Sunny</div>
            </div>
        </div>
    </main>
    <script>
        const searchBtn = document.querySelector("#search");
        const inputSearch = document.querySelector("input");
        const tempElem = document.querySelector(".temprature");
        const locationElem = document.querySelector(".location");
        const timeElem = document.querySelector(".time");
        const dayElem = document.querySelector(".day");
        const dateElem = document.querySelector(".date")
        const iconElem = document.querySelector(".icon");
        const conditionElem = document.querySelector(".condition");
        searchBtn.addEventListener("click", function () {
            const location = inputSearch.value;
            if (location) {
                // get data
                // update date into dom
                fetchWeather(location).then((data) => {
                    if (data == null) {

                    } else {
                        updateData(data);
                    }
                });
                inputSearch.value = "";
            }
        })
        function updateData(data) {
            //   extract required data
            const temp = data.current.temp_c;
            const location = data.location.name;
            const dateTime = data.location.localtime;
            const [date, time] = dateTime.split("");
            const icon = data.current.condition.icon;
            const condition = data.current.condition.text;

            // update data
            tempElem.textContent = temp + "Â°C";
            locationElem.textContent = location;
            dateElem.innerText = date;
            timeElem.innerText = time;
            iconElem.src = icon;
            conditionElem.textContent = condition;



        }
        async function fetchWeather(location) {
            const url = `http://api.weatherapi.com/v1/current.json?key=dc3cb5b61c3b4d9a9ec144601240409&q=${location}&aqi=no`
            const response = await fetch(url);
            if (response.status == 400) {
                alert("Invalid Location");
            } else if (response.status == 200) {
                const json = await response.json();
                return json;
            }

        }
    </script>
</body>

</html>